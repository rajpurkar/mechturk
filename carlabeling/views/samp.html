<!-- This file needs to be hosted on an external server.  -->
<html>
    <script language="Javascript">
        //
        // This method Gets URL Parameters (GUP)
        //
        function gup( name )
        {
            var regexS = "[\\?&]"+name+"=([^&#]*)";
            var regex = new RegExp( regexS );
            var tmpURL = window.location.href;
            var results = regex.exec( tmpURL );
            if( results == null )
            return "";
            else
            return results[1];
        }

        //
        // This method decodes the query parameters that were URL-encoded
        //
        function decode(strToDecode)
        {
            var encoded = strToDecode;
            return unescape(encoded.replace(/\+/g,  " "));
        }

    </script>
    <head>
        <title>Car-Labeling</title>
        <style type="text/css">
          body {
            padding: 50px;
            font: 14px "Lucida Grande", Helvetica, Arial, sans-serif;
            text-align: center;
          }

          a {
            color: #00B7FF;
          }

          #bt{
            padding: 10px 20px;
            font-size: large;
          }
        </style>
    </head>
    <body>
        <h1>Box Around Cars</h1>
        <div id="target">In the image shown, you will be drawing a box around every car.</div>
        <div id="message">Please click the top left corner of a car to start.</div>
        <canvas id="myCanvas" width="700" height="500"><your>browser does not support canvas, which is required for this</your>application. Please download the latest version of a(href='https://www.google.com/intl/en/chrome/browser/') Google Chrome</canvas>
        <div>
        <button id="bt" type="button">Submit</button>
        </div>
        <form id="mturk_form" method="POST" action="http://www.mturk.com/mturk/externalSubmit">
            <input type="hidden" id="assignmentId" name="assignmentId" value="">
            <textarea type="textarea" name="markings" id="marks"></textarea> 
            <input id="submitButton" type="submit" name="Submit" value="Submit">
        </form>
        <script language="Javascript">
            document.getElementById('pageFrame').src = decode(gup('url'));
            document.getElementById('assignmentId').value = gup('assignmentId');
            //
            // Check if the worker is PREVIEWING the HIT or if they've ACCEPTED the HIT
            //
            if (gup('assignmentId') == "ASSIGNMENT_ID_NOT_AVAILABLE")
            {
                // If we're previewing, disable the button and give it a helpful message
                document.getElementById('submitButton').disabled = true;
                $('bt').disabled = true;
                var preview = true;
                document.getElementById('submitButton').value = "You must ACCEPT the HIT before you can submit the results.";
                } else {
                var form = document.getElementById('mturk_form');
                if (document.referrer && (document.referrer.indexOf('workersandbox') != -1) ) {
                    form.action = "http://workersandbox.mturk.com/mturk/externalSubmit";
                }
            }
        </script>
        <script src="javascripts/jquery-1.8.3.min.js"></script>
        <script src="javascripts/classes.js"></script>
        <script src="javascripts/helper.js"></script>
        <script src="javascripts/main.js"></script>
    </body>
</html>
